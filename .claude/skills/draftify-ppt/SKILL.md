---
name: draftify-ppt
description: This skill generates planning documents (기획서) in PowerPoint format from analyzed screen data and project artifacts. It should be invoked by the /auto-draft skill during Phase 4 to create the final PPT output. Not intended for direct user invocation.
---

# Draftify PPT Generator

## Overview

This skill transforms analyzed project data into a structured PowerPoint planning document (기획서) following the standard 10-section format. It is invoked by the /auto-draft skill during Phase 4 of the document generation workflow.


> Note: All sections (01-10) are generated by Phase 3 agents; this skill only renders PPT from markdown.

## Input Requirements

The skill expects the following files to exist in the project's output directory:

```
outputs/<project-name>/
?? screenshots/                    # Captured screen images
?? analysis/
?  ?? analyzed-structure.json      # Consolidated analysis data
?? sections/
?  ?? 01-cover.md                  # Cover
?  ?? 02-revision-history.md       # Revision history
?  ?? 03-table-of-contents.md      # Table of contents
?  ?? 04-section-divider.md        # Section divider pages
?  ?? 05-glossary.md               # Glossary
?  ?? 06-policy-definition.md      # Policies
?  ?? 07-process-flow.md           # Process flow
?  ?? 08-screen-definition.md      # Screen definitions
?  ?? 09-references.md             # References (optional)
?  ?? 10-eod.md                    # End of document
?? validation/
   ?? validation-report.md         # Quality validation results
```

## Output

Generates `<project>-draft-V{version}.pptx` in the project output directory:

```
outputs/<project-name>/
└─ <project>-draft-V{version}.pptx
```


> Note: Filename is normalized from project metadata (spaces -> hyphens, lowercased) and version is taken from analyzed-structure.json.

## Document Structure

The generated PPT follows the 10-section structure defined in `docs/design/auto-draft-guideline.md`:

| Section | Content |
|---------|---------|
| 1. 표지 | Cover with project metadata |
| 2. 변경 이력 | Revision history table |
| 3. 목차 | Table of contents with screen IDs |
| 4. 섹션 타이틀 | Section divider pages |
| 5. 용어 정의 | Glossary terms from `05-glossary.md` |
| 6. 정책 정의 | Policies with POL-* IDs from `06-policy-definition.md` |
| 7. 프로세스 흐름 | Process flow from `07-process-flow.md` |
| 8. 화면 정의 | Screen definitions with SCR-* IDs from `08-screen-definition.md` |
| 9. 참고 문헌 | Reference documents |
| 10. EOD | End of document marker |

## Generation Workflow

1. **Read analyzed data**: Load `analyzed-structure.json` and all section markdown files (01-10)
2. **Parse section markdown**: Convert each section into slide-ready structures
3. **Render slides**: Build slides based on section markdown content
4. **Insert screenshots**: Embed captured screenshots in screen definition slides
5. **Apply template styling**: Use `assets/ppt_template.pptx` as base
6. **Save output**: Write `<project>-draft-V{version}.pptx`

## ID Scheme Compliance

All IDs must follow the scheme defined in the guideline:

- **Policy IDs**: `POL-{CATEGORY}-{SEQ}` (e.g., POL-AUTH-001)
- **Screen IDs**: `SCR-{SEQ}` (e.g., SCR-001)
- **Element IDs**: `{TYPE}-{SEQ}` (e.g., BTN-001, FORM-001)
- **API IDs**: `API-{SEQ}` (e.g., API-001)

## Screen Definition Slide Layout

Each screen definition uses 1-2 slides with this structure:

**Slide 1 (Required)**:
- Screen ID and name (header)
- Screenshot image (left 60%)
- Basic info panel (right 40%): purpose, entry/exit conditions

**Slide 2 (If needed)**:
- UI element table
- Process flow within screen
- Related policies (POL-* references)

## Usage by /auto-draft

The /auto-draft skill invokes this skill via Skill tool:

```
Task: Generate final PPT document
Input: outputs/<project-name>/ directory path
Timeout: 10 minutes
```

## Error Handling

- **Missing section files**: Generate placeholder slide with warning
- **Missing screenshots**: Use placeholder image with screen ID
- **Invalid IDs**: Log warning, continue generation
- **Template errors**: Fall back to basic slide layout

## Resources

### scripts/
- `generate_ppt.py`: Main PPT generation script using python-pptx

### docs/design/
- `auto-draft-guideline.md`: Complete specification for document structure and ID schemes

### assets/
- `ppt_template.pptx`: PowerPoint template with predefined layouts and styling
- `JOURNEYITSELF-BOLD 3.TTF`: Bold font for headers
- `JOURNEYITSELF-REGULAR 3.TTF`: Regular font for body text
- `JOURNEYITSELF-LIGHT 3.TTF`: Light font for captions

## Dependencies

- Python 3.8+
- python-pptx library
- Pillow (for image processing)
